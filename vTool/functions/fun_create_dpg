<#
.SYNOPSIS
    create distributed portgroup
.DESCRIPTION
    This will create a csv file, open it for you with proper headers, you have to populate the values as per the heading separated by a comma.
    If a value contains space then enclose it with quotation marks. ex: dummy portgroup should be "dummy portgroup"
    If a value contains an integer then enclose it with quotation marks. ex: vswitch05-A should be "vswitch05-A"
    separate values only by a comma and avoid spaces.
.NOTES
    File Name      : fun_create_dpg.ps1
    Author         : gajendra d ambi
    Date           : february 2016
    Prerequisite   : PowerShell v3+, powercli 6+ over Vista and upper.
    Copyright      - None
.LINK
    Script posted over:
    
#>

#Start of the script

$file = "$PSScriptRoot\dpg.csv"
ni -ItemType file $file -Force
$file | select dvswitch,portgroup,vlan | Export-Csv $file
Write-Host "open the dpg.csv (from the folder where this script is being run) with a text editor, populate the values as per the instructions given below, save & close it" -ForegroundColor Yellow
Write-Host 'If a value contains space then enclose it with quotation marks. ex: dummy portgroup should be "dummy portgroup"
            If a value contains an integer then enclose it with quotation marks. ex: vswitch05-A should be "vswitch05-A"
            Separate values only by a comma and avoid spaces.' -Foregroupcolor Yellow
Read-Host "hit enter/return to proceed"

Import-CSV $file | Foreach-Object{
Write-Host creating $_.portgroup with vlan id $_.vlan on $_.dvswitch
Get-VDSwitch -Name $_.dvswitch | New-VDPortgroup -Name $_.portgroup -VlanId $_.vlan -confirm:$false
}
